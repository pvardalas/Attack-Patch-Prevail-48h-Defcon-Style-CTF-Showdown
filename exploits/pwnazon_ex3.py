#!/usr/bin/env python3
from pwn import *
import argparse
import requests
parser = argparse.ArgumentParser()
parser.add_argument('--ip', required=True)
parser.add_argument('-o', required=True)
#you can add any more arguments required here!!!
args = parser.parse_args()

port = 8005#add the port of the service you are attacking
# p = remote(args.ip, port)

#you script starts here
r = requests.get(f'http://{args.ip}:{port}/key',timeout=30)
if r.status_code != 200:
    print("Failed to retrieve key")
    exit(1)
flag = r.text.strip()
#and ends here

with open(args.o, 'a') as f:
    f.write(flag + '\n')
print(f"Flag captured: {flag}")

# p.close()
